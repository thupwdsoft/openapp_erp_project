<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="view_openapp_subcontract_list" model="ir.ui.view">
    <field name="name">openapp.subcontract.list</field>
    <field name="model">openapp.subcontract</field>
    <field name="arch" type="xml">
      <list string="Hợp đồng thầu phụ" default_order="id desc">
        <field name="name"/>
        <field name="partner_id"/>
        <field name="project_id"/>
        <field name="amount_total"/>
        <field name="state" widget="badge"/>
      </list>
    </field>
  </record>

  <record id="view_openapp_subcontract_form" model="ir.ui.view">
    <field name="name">openapp.subcontract.form</field>
    <field name="model">openapp.subcontract</field>
    <field name="arch" type="xml">
      <form string="Hợp đồng thầu phụ">
        <header>
          <!-- Statusbar -->
          <field name="state"
                widget="statusbar"
                statusbar_visible="draft,running,done"
                statusbar_colors='{"draft":"blue","running":"green","done":"green"}'/>

          <!-- Bắt đầu: chỉ hiện ở draft -->
          <button name="action_start"
                  type="object"
                  string="Bắt đầu"
                  class="oe_highlight"
                  modifiers="{'invisible': [('state','!=','draft')]}"/>

          <!-- Hoàn tất: chỉ hiện ở running -->
          <button name="action_done"
                  type="object"
                  string="Hoàn tất"
                  class="oe_highlight"
                  modifiers="{'invisible': [('state','!=','running')]}"/>

          <!-- Đưa về nháp: chỉ hiện ở done -->
          <button name="action_reset_to_draft"
                  type="object"
                  string="Đưa về nháp"
                  modifiers="{'invisible': [('state','!=','done')]}"/>
        </header>

        <sheet>

          <!-- SMART BUTTON -->
          <div class="oe_button_box">
            <button class="oe_stat_button" name="action_view_purchase_orders" type="object" icon="fa-shopping-cart"
                    invisible="purchase_count == 0">
              <field name="purchase_count" widget="statinfo" string="Đơn mua"/>
            </button>
          </div>

          <group>
            <field name="name" readonly="1"/>
            <field name="partner_id"/>
            <field name="project_id"/>
            <field name="amount_total"/>
          </group>

          <group string="Liên kết">
            <field name="purchase_order_ids" widget="many2many_tags" readonly="1"/>
          </group>

        </sheet>
      </form>
    </field>
  </record>

  <record id="action_openapp_subcontract" model="ir.actions.act_window">
    <field name="name">Hợp đồng thầu phụ</field>
    <field name="res_model">openapp.subcontract</field>
    <field name="view_mode">list,form</field>
  </record>
</odoo>
